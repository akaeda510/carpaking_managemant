<%= turbo_frame_tag "modal" do %>
  <%# 1. 背景の半透明オーバーレイ（画面全体を固定） %>
  <div class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900/60 backdrop-blur-sm p-4">

    <%# 2. 小さいタブ（モーダル本体）：幅を制限し、角丸・白背景 %>
    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200">

      <%# ヘッダー %>
      <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50">
        <h3 class="text-lg font-bold text-gray-900">
          <i class="fa-solid fa-car-side mr-2 text-blue-600"></i>
          <%= @contractor.full_name %> 様の契約状況
        </h3>

        <%# 閉じるボタン（_topを指定してページ全体を戻す） %>
        <%= link_to contractor_path(@contractor), data: { turbo_frame: "_top" }, class: "p-2 rounded-full hover:bg-gray-200 text-gray-400 hover:text-gray-600 transition" do %>
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        <% end %>
      </div>

      <%# コンテンツ部分（テーブルをここに入れる） %>
      <div class="p-6 overflow-y-auto max-h-[60vh]">
        <div class="overflow-x-auto border border-gray-100 rounded-lg">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase">駐車スペース</th>
                <th class="px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase">契約開始日</th>
                <th class="px-4 py-3 text-right text-xs font-semibold text-gray-500 uppercase">操作</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <% if @contract_parking_spaces.any? %>
                <% @contract_parking_spaces.each do |contract| %>
                  <tr class="hover:bg-blue-50/30 transition">
                    <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                      <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-xs mr-2">区画</span>
                      <%= contract.parking_space.name %>
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-600">
                      <%= contract.started_at&.strftime("%Y/%m/%d") || "未設定" %>
                    </td>
                    <td class="px-4 py-4 whitespace-nowrap text-right text-sm">
                      <%= link_to "解除", contractor_contract_parking_space_path(@contractor, contract), 
                          data: { turbo_method: :delete, turbo_confirm: "この駐車スペースの契約を解除しますか？" },
                          class: "text-red-600 hover:text-red-800 font-medium" %>
                    </td>
                  </tr>
                <% end %>
              <% else %>
                <tr>
                  <td colspan="3" class="px-4 py-12 text-center text-gray-400 italic">
                    現在、契約中の駐車スペースはありません。
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>

      <%# フッター：アクションボタン %>
      <div class="px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end space-x-3">
        <%= link_to "閉じる", contractor_path(@contractor), data: { turbo_frame: "_top" }, class: "px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 shadow-sm" %>
        <%= link_to "新規契約を追加", "#", class: "px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 shadow-md transition" %>
      </div>

    </div> <%# モーダル本体 閉 %>
  </div> <%# オーバーレイ 閉 %>
<% end %>
