<div class="max-w-4xl mx-auto p-8 bg-white shadow-lg rounded-lg mt-10">
  <h1 class="text-3xl font-bold text-gray-800 border-b pb-4 mb-6">
    駐車場所: 詳細情報
  </h1>

  <div class="space-y-4">
    <div class="flex items-center">
      <p class="w-32 font-semibold text-gray-600">名前:</p>
      <p class="text-gray-900"><%= @parking_space.name %></p>
    </div>

    <div class="flex items-center">
      <p class="w-32 font-semibold text-gray-600">駐車タイプ:</p>
      <div class="text-gray-900">
        <span class="inline-flex items-center px-3 py-1 rounded-md text-sm font-medium bg-slate-100 text-slate-700 border border-slate-200">
          <%= @parking_space.parking_type_i18n %>
        </span>
      </div>
    </div>

    <div class="flex items-center">
      <p class="w-32 font-semibold text-gray-600">横幅:</p>
      <p class="text-gray-900"><%= @parking_space.width %> m</p>
    </div>

    <div class="flex items-center">
      <p class="w-32 font-semibold text-gray-600">長さ:</p>
      <p class="text-gray-900"><%= @parking_space.length %> m</p>
    </div>

    <% if @parking_space.parking_type == 'garage' && @parking_space.garage_detail.present? %>
      <div class="flex items-center">
        <p class="w-32 font-semibold text-gray-600">高さ:</p>
        <p class="text-gray-600">
        <%= @parking_space.garage_detail.height %> m
        </p>
      </div>
    <% end %>

    <div class="flex items-start">
      <p class="w-32 font-semibold text-gray-600">オプション:</p>
      <div class="flex flex-wrap gap-2 flex-1">
        <% if @parking_space.parking_space_options.any? %>
          <% @parking_space.parking_space_options.each do |option| %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-200">
              <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-indigo-400" fill="currentColor" viewBox="0 0 8 8">
                <circle cx="4" cy="4" r="3" />
              </svg>
              <%= option.name %>
            </span>
          <% end %>
        <% else %>
          <p class="text-gray-400 italic text-sm">特になし</p>
        <% end %>
      </div>
    </div>

    <%# --- ここから契約者情報の追加 --- %>
    <div class="flex items-start border-t pt-4 mt-4">
      <p class="w-32 font-semibold text-gray-600">現在の契約状況:</p>
      <div class="flex-1">
        <%# 現在有効な契約を取得 %>
        <% active_contract = @parking_space.contract_parking_spaces.find_by(end_date: ::ACTIVE_CONTRACT_END_DATE) %>

        <% if active_contract %>
          <div class="bg-green-50 border border-green-200 rounded-md p-3">
            <p class="text-green-800 font-bold">
            👤 契約中: <%= link_to active_contract.contractor.first_name, contractor_path(active_contract.contractor), class: "underline" %>
            </p>
            <p class="text-sm text-green-700">契約開始日: <%= active_contract.start_date.strftime("%Y/%m/%d") %></p>
          </div>
        <% else %>
          <div class="bg-gray-50 border border-gray-200 rounded-md p-3 text-gray-500">
            <p>現在空き（契約なし）</p>
          </div>
        <% end %>
      </div>
    </div>

    <%# 5. 説明 (description) %>
    <div class="border-t pt-4 mt-6">
      <p class="font-semibold text-gray-600 mb-2">説明:</p>
      <p class="text-gray-900 whitespace-pre-wrap"><%= @parking_space.description %></p>
    </div>
  </div>

  <%# 💡 ボタンセクション %>
  <div class="mt-8 pt-6 border-t flex space-x-4">
    <%# 編集ボタン %>
    <%= link_to '編集', edit_parking_lot_parking_space_path, class: "px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition duration-150" %>

    <%# 削除ボタン %>
    <%= link_to '削除', parking_lot_parking_space_path(@parking_lot, @parking_space), 
    data: { 
      turbo_method: :delete, 
      turbo_confirm: "本当にこの駐車スペースを削除しますか？" 
    },
    class: "px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition duration-150" %>

  <%# 戻るボタン (親の ParkingLot の index に戻ることを想定) %>
  <%= link_to '一覧に戻る', parking_lot_parking_spaces_path, class: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-150" %>
  </div>
</div>
